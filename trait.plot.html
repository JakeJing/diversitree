<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>trait.plot. diversitree 0.9-7</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Richard G. FitzJohn">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">diversitree 0.9-7</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Plot a Phylogeny and Traits</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>trait.plot(tree, dat, cols, lab=names(cols), str=NULL,  class=NULL, type="f", w=1/50,  legend=length(cols) > 1, cex.lab=.5,  font.lab=3, cex.legend=.75, margin=1/4,  check=TRUE, quiet=FALSE, ...)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>tree</dt>
      <dd>Phylogenetic tree, in ape format.</dd>
      <dt>dat</dt>
      <dd>A <code>data.frame</code> of trait values.  The row names must be
    the same names as the tree (<code>tree$tip.label</code>), and each column
    contains the states (0, 1, etc., or <code>NA</code>).  The column names
    must give the trait names.</dd>
      <dt>cols</dt>
      <dd>A list with colors.  Each element corresponds to a trait
    and must be named so that all names appear in <code>names(dat)</code>.
    Each of these elements is a vector of colors, with length matching
    the number of states for that trait.  Traits will be plotted in the
    order given by <code>cols</code>.</dd>
      <dt>lab</dt>
      <dd>Alternative names for the legend (perhaps longer or more
    informative).  Must be in the same order as <code>cols</code>.</dd>
      <dt>str</dt>
      <dd>Strings used for the states in the legend.  If <code>NULL</code>
    (the default), the values in <code>dat</code> are used.</dd>
      <dt>class</dt>
      <dd>A vector along <code>phy$tip.label</code> giving a higher level
    classification (e.g., genus or family).  No checking is done to
    ensure that such classifications are not polyphyletic.</dd>
      <dt>type</dt>
      <dd>Plot type (same as <code>type</code> in <code>?plot.phylo</code>).
    Currently only <code>f</code> (fan) and <code>p</code> (rightwards phylogram)
    are implemented.</dd>
      <dt>w</dt>
      <dd>Width of the trait plot, as a fraction of the tree depth.</dd>
      <dt>legend</dt>
      <dd>Logical: should a legend be plotted?</dd>
      <dt>cex.lab, font.lab</dt>
      <dd>Font size and type for the tip labels.</dd>
      <dt>cex.legend</dt>
      <dd>Font size for the legend.</dd>
      <dt>margin</dt>
      <dd>How much space, relative to the total tree depth, should
    be reserved when plotting a higher level classification.</dd>
      <dt>check</dt>
      <dd>When TRUE (by default), this will check that the classes
    specified by <code>class</code> are monophyletic.  If not, classes will be 
    concatenated and a warning raised.</dd>
      <dt>quiet</dt>
      <dd>When TRUE (FALSE by default), this suppresses the warning
    caused by <code>check=TRUE</code>.</dd>
      <dt>...</dt>
      <dd>Additional arguments passed through to phylogeny plotting
    code (similar to <code>ape</code>'s <code>plot.phylo</code>).</dd>
    </dl>
    
    <div class="Description">
      <h2>Description</h2>
      
      <p>Plot a phylogeny and label the tips with traits.
  This function is experimental, and may change soon.  Currently it can
  handle discrete-valued traits and two basic tree shapes.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'>## These are the parameters: they are a single speciation and extinction
## rate, then 0-&gt;1 (trait A), 1-&gt;0 (A), 0-&gt;1 (B) and 1-&gt;0 (B).
colnames(musse.multitrait.translate(2, depth=0))
</div>
<div class='output'>[1] &quot;lambda0&quot; &quot;mu0&quot;     &quot;qA01.0&quot;  &quot;qA10.0&quot;  &quot;qB01.0&quot;  &quot;qB10.0&quot; 
</div>
<div class='input'>
## Simulate a tree where trait A changes slowly and B changes rapidly.
set.seed(1)
phy &lt;- tree.musse.multitrait(c(.1, 0, .01, .01, .05, .05),
                             n.trait=2, depth=0, max.taxa=100,
                             x0=c(0,0))
## Here is the matrix of tip states (each row is a species, each column
## is a trait).
head(phy$tip.state)
</div>
<div class='output'>    A B
sp1 0 0
sp2 0 1
sp3 1 1
sp4 0 1
sp5 0 0
sp6 0 0
</div>
<div class='input'>
trait.plot(phy, phy$tip.state,
           cols=list(A=c(&quot;pink&quot;, &quot;red&quot;), B=c(&quot;lightblue&quot;, &quot;blue&quot;)))
</div>
<strong class='warning'>Warning message:
Name partially matched in data frame</strong>
<strong class='warning'>Warning message:
Name partially matched in data frame</strong>
<p><img src='trait.plot-8.png' alt='' width='400' height='400' /></p>
<div class='input'>
nodes &lt;- c(&quot;nd5&quot;, &quot;nd4&quot;, &quot;nd7&quot;, &quot;nd11&quot;, &quot;nd10&quot;, &quot;nd8&quot;)
grp &lt;- lapply(nodes, get.descendants, phy, tips.only=TRUE)
class &lt;- rep(NA, 100)
for ( i in seq_along(grp) )
  class[grp[[i]]] &lt;- paste(&quot;group&quot;, LETTERS[i])

## Now, &#39;class&#39; is a vector along phy$tip.label indicating which of six
## groups each species belongs.

## Plotting the phylogeny with these groups:
trait.plot(phy, phy$tip.state,
           cols=list(A=c(&quot;pink&quot;, &quot;red&quot;), B=c(&quot;lightblue&quot;, &quot;blue&quot;)),
           class=class, font=1, cex.lab=1, cex.legend=1)
</div>
<strong class='warning'>Warning message:
Name partially matched in data frame</strong>
<strong class='warning'>Warning message:
Name partially matched in data frame</strong>
<p><img src='trait.plot-12.png' alt='' width='400' height='400' /></p>
<div class='input'>
## Add another state, showing values 1:3, names, and trait ordering.
tmp &lt;- sim.character(phy, c(-.1, .05, .05, .05, -.1, .05, .05, 0.05, -.1), 
                     model=&quot;mkn&quot;, x0=1)
phy$tip.state &lt;- data.frame(phy$tip.state, C=tmp)
trait.plot(phy, phy$tip.state,
           cols=list(C=c(&quot;palegreen&quot;, &quot;green3&quot;, &quot;darkgreen&quot;),
                     A=c(&quot;pink&quot;, &quot;red&quot;), B=c(&quot;lightblue&quot;, &quot;blue&quot;)),
           lab=c(&quot;Animal&quot;, &quot;Vegetable&quot;, &quot;Mineral&quot;),
           str=list(c(&quot;crane&quot;, &quot;toad&quot;, &quot;snail&quot;), c(&quot;kale&quot;, &quot;carrot&quot;), 
                    c(&quot;calcite&quot;, &quot;beryl&quot;)))
</div>
<strong class='warning'>Warning message:
Name partially matched in data frame</strong>
<strong class='warning'>Warning message:
Name partially matched in data frame</strong>
<strong class='warning'>Warning message:
Name partially matched in data frame</strong>
<p><img src='trait.plot-17.png' alt='' width='400' height='400' /></p>
<div class='input'>
## Rectangular/phylogram plot with groups.
trait.plot(ladderize(phy, right=FALSE), phy$tip.state, type=&quot;p&quot;,
           cols=list(A=c(&quot;pink&quot;, &quot;red&quot;), B=c(&quot;lightblue&quot;, &quot;blue&quot;),
                     C=c(&quot;palegreen&quot;, &quot;green3&quot;, &quot;darkgreen&quot;)),
           class=class, font=1, cex.lab=1)
</div>
<p><img src='trait.plot-19.png' alt='' width='400' height='400' /></p></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>trait.plot</li>
    </ul>
    <ul>
      <li>hplot</li>
    </ul> -->
      
    
    <h2>Author</h2>
    Richard G. FitzJohn
    
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>